import{j as r}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.BR1w_nJd.js";import{F as O}from"./fileUploader.D55Ta1Pr.js";import"./i18n.D5xAk-hA.js";import{u as q}from"./useTranslation.C-NthtKk.js";import{c as W}from"./createLucideIcon._FvKnKwF.js";import{R as B}from"./rotate-ccw.3wE7q0Bs.js";import{D as G}from"./download.WYS23KZw.js";import{U as J}from"./index.BUxk5OiF.js";import"./_commonjsHelpers.D6-XlEtG.js";import"./utils.fNskMoFt.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]],Q=W("mouse-pointer-click",K);function ce(){const{t:n}=q(),[C,T]=l.useState(null),[a,y]=l.useState(null),[N,k]=l.useState([]),[M,I]=l.useState(!1),[i,h]=l.useState({x:0,y:0}),[x,m]=l.useState({x:0,y:0}),[f,p]=l.useState(null),[w,D]=l.useState("blur"),[b,F]=l.useState(15),d=l.useRef(null),s=l.useRef(null),P=t=>{if(t&&t.length>0){const e=new FileReader;e.addEventListener("load",()=>{const o=new Image;o.src=e.result,o.onload=()=>{T(e.result),y(o),k([e.result]),p(null),h({x:0,y:0}),m({x:0,y:0})}}),e.readAsDataURL(t[0])}},U=l.useCallback(()=>{if(!a||!d.current)return;const t=d.current,e=t.getContext("2d");if(e&&((t.width!==a.width||t.height!==a.height)&&(t.width=a.width,t.height=a.height,s.current&&(s.current.width=a.width,s.current.height=a.height)),e.clearRect(0,0,t.width,t.height),e.drawImage(a,0,0),f&&f.w>0&&f.h>0)){const{x:o,y:c,w:u,h:g}=f;if(e.save(),e.beginPath(),e.rect(o,c,u,g),e.clip(),w==="blur")e.filter=`blur(${b}px)`,e.drawImage(a,0,0),e.filter="none";else{const j=Math.max(2,Math.floor(b/3));for(let v=c;v<c+g;v+=j)for(let _=o;_<o+u;_+=j){const S=e.getImageData(_,v,1,1).data;e.fillStyle=`rgb(${S[0]},${S[1]},${S[2]})`,e.fillRect(_,v,j,j)}}e.restore()}},[a,f,w,b]);l.useEffect(()=>{U()},[U]);const L=t=>{if(!s.current)return{x:0,y:0};const e=s.current.getBoundingClientRect(),o=s.current.width/e.width,c=s.current.height/e.height;let u,g;return"touches"in t?(u=t.touches[0].clientX,g=t.touches[0].clientY):(u=t.clientX,g=t.clientY),{x:(u-e.left)*o,y:(g-e.top)*c}},z=t=>{if(!a)return;I(!0);const e=L(t);h(e),m(e)},E=t=>{if(!M||!a)return;const e=L(t);m(e),$(e)},R=()=>{if(!M)return;I(!1);const t=x.x-i.x,e=x.y-i.y;Math.abs(t)>10&&Math.abs(e)>10?X():s.current&&s.current.getContext("2d")?.clearRect(0,0,s.current.width,s.current.height)},$=t=>{if(!s.current)return;const e=s.current.getContext("2d");if(!e)return;e.clearRect(0,0,s.current.width,s.current.height);const o=t.x-i.x,c=t.y-i.y;e.strokeStyle="#3b82f6",e.lineWidth=2,e.setLineDash([5,5]),e.strokeRect(i.x,i.y,o,c),e.fillStyle="rgba(59, 130, 246, 0.1)",e.fillRect(i.x,i.y,o,c)},X=()=>{const t=x.x-i.x,e=x.y-i.y;Math.abs(t)===0||Math.abs(e)===0||(p({x:t<0?x.x:i.x,y:e<0?x.y:i.y,w:Math.abs(t),h:Math.abs(e)}),requestAnimationFrame(()=>{if(!d.current)return;const o=d.current.toDataURL("image/png");k(u=>[...u,o]);const c=new Image;c.src=o,c.onload=()=>{y(c),p(null),h({x:0,y:0}),m({x:0,y:0}),s.current&&s.current.getContext("2d")?.clearRect(0,0,s.current.width,s.current.height)}}))},Y=()=>{if(N.length<=1)return;const t=[...N];t.pop();const e=t[t.length-1];k(t);const o=new Image;o.src=e,o.onload=()=>{y(o),p(null),h({x:0,y:0}),m({x:0,y:0})}},A=()=>{d.current&&d.current.toBlob(t=>{if(t){const e=URL.createObjectURL(t),o=document.createElement("a");o.href=e,o.download="blurred-image.png",o.click(),URL.revokeObjectURL(e)}})},H=()=>{if(!C)return;const t=new Image;t.src=C,t.onload=()=>{y(t),p(null),h({x:0,y:0}),m({x:0,y:0}),s.current&&s.current.getContext("2d")?.clearRect(0,0,s.current.width,s.current.height)}};return r.jsx("div",{className:"max-w-5xl mx-auto",children:C?r.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 w-full max-w-7xl",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("p",{className:"text-center text-sm text-gray-500 mb-4 bg-blue-50 py-2 px-4 rounded-lg border border-blue-100",children:[r.jsx(Q,{size:14,className:"inline mr-2"}),n("tools_ui.image_blur.instruction")]}),r.jsxs("div",{className:"relative overflow-auto border border-gray-200 rounded-xl shadow-lg bg-white w-fit max-w-150 max-h-150",children:[r.jsx("canvas",{ref:d,className:"block"}),r.jsx("canvas",{ref:s,onMouseDown:z,onMouseMove:E,onMouseUp:R,onMouseLeave:R,onTouchStart:z,onTouchMove:E,onTouchEnd:R,className:"absolute top-0 left-0 block touch-none cursor-crosshair",style:{pointerEvents:"auto"}})]})]}),r.jsx("div",{className:"w-full lg:w-80 shrink-0",children:r.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-lg sticky top-6 space-y-6",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-900",children:n("tools_ui.image_blur.settings")}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:n("tools_ui.image_blur.effect_type")}),r.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[r.jsx("button",{onClick:()=>D("blur"),className:`flex-1 px-3 py-2 rounded text-sm font-semibold transition-all ${w==="blur"?"bg-white text-blue-600 shadow-sm":"text-gray-600"}`,children:n("tools_ui.image_blur.blur")}),r.jsx("button",{onClick:()=>D("pixelate"),className:`flex-1 px-3 py-2 rounded text-sm font-semibold transition-all ${w==="pixelate"?"bg-white text-purple-600 shadow-sm":"text-gray-600"}`,children:n("tools_ui.image_blur.pixelate")})]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:n("tools_ui.image_blur.intensity")}),r.jsx("span",{className:"text-sm font-bold text-blue-600",children:b})]}),r.jsx("input",{type:"range",min:"5",max:"50",value:b,onChange:t=>F(Number(t.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[r.jsx("span",{children:n("tools_ui.image_blur.light")}),r.jsx("span",{children:n("tools_ui.image_blur.heavy")})]})]}),r.jsxs("div",{className:"border-t border-gray-200 pt-6 space-y-3",children:[r.jsxs("button",{onClick:Y,disabled:N.length<=1,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-orange-600 text-white hover:bg-orange-700 rounded-lg font-bold text-sm disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[r.jsx(B,{size:18})," ",n("tools_ui.image_blur.undo")]}),r.jsxs("button",{onClick:H,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-medium text-sm transition-colors",children:[r.jsx(B,{size:18})," ",n("tools_ui.image_blur.reset")]})]}),r.jsxs("div",{className:"border-t border-gray-200 pt-6 space-y-3",children:[r.jsxs("button",{onClick:A,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-gray-900 text-white hover:bg-black rounded-lg font-bold text-sm transition-colors",children:[r.jsx(G,{size:18})," ",n("tools_ui.image_blur.download")]}),r.jsxs("button",{onClick:()=>window.location.reload(),className:"w-full flex items-center justify-center gap-2 px-4 py-3 border-2 border-gray-300 hover:border-gray-400 text-gray-700 rounded-lg font-medium text-sm transition-colors",children:[r.jsx(J,{size:18})," ",n("tools_ui.image_blur.upload_new")]})]})]})})]}):r.jsx(O,{onFilesSelected:P,accept:{"image/*":[".jpg",".jpeg",".png",".webp",".gif"]},multiple:!1,title:n("tools_ui.image_blur.upload_title")})})}export{ce as default};
