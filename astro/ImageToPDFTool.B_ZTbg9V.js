import{j as e}from"./createLucideIcon.CH-mSxXv.js";import{r as j}from"./index.BR1w_nJd.js";import{P as w,a as N}from"./ProcessButton.cMndhx_-.js";import{F as S}from"./fileUploader.BLbgfAQx.js";import{F as D}from"./FileSaver.min.D-v3scGK.js";import{u as I,a as v,D as _,c as P,S as F,r as C,b as B,s as A,K as E,P as R,d as T,e as k,C as q}from"./sortable.esm.B22XIUkC.js";import"./i18n.0Kt4fEA7.js";import{u as K}from"./useTranslation.C-NthtKk.js";import{A as M}from"./arrow-down.3Luxqwhg.js";import{X as U}from"./x.PcIF29Xl.js";import"./_commonjsHelpers.D6-XlEtG.js";import"./utils.fNskMoFt.js";import"./loader-circle.D30OAAi7.js";import"./index.CeYlJSet.js";import"./index.B80MxM07.js";function $({id:o,preview:r,fileName:l,onRemove:d}){const{attributes:c,listeners:m,setNodeRef:g,transform:h,transition:p,isDragging:u}=k({id:o}),b={transform:q.Transform.toString(h),transition:p,zIndex:u?10:1,opacity:u?.5:1};return e.jsxs("div",{ref:g,style:b,...c,...m,className:"group relative aspect-square bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow cursor-grab active:cursor-grabbing",children:[e.jsx("img",{src:r,alt:l,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onPointerDown:y=>{y.stopPropagation(),d(o)},className:"p-1 bg-red-500 text-white rounded-full hover:bg-red-600 shadow-sm",children:e.jsx(U,{className:"w-3 h-3"})})})]})}function re(){const{t:o}=K(),[r,l]=j.useState([]),[d,c]=j.useState(!1),[m,g]=j.useState(null),h=I(v(R),v(E,{coordinateGetter:A})),p=t=>{const i=t.map(s=>({id:`img-${Date.now()}-${Math.random()}`,file:s,preview:URL.createObjectURL(s)}));l(s=>[...s,...i])},u=t=>{l(i=>i.filter(s=>s.id!==t))},b=t=>{const{active:i,over:s}=t;i.id!==s.id&&l(n=>{const f=n.findIndex(x=>x.id===i.id),a=n.findIndex(x=>x.id===s.id);return T(n,f,a)}),g(null)},y=async()=>{if(r.length!==0){c(!0);try{const t=await N.create();for(const n of r){const f=await n.file.arrayBuffer();let a;if(n.file.type==="image/jpeg"||n.file.type==="image/jpg")a=await t.embedJpg(f);else if(n.file.type==="image/png")a=await t.embedPng(f);else continue;t.addPage([a.width,a.height]).drawImage(a,{x:0,y:0,width:a.width,height:a.height})}const i=await t.save(),s=new Blob([i],{type:"application/pdf"});D.saveAs(s,`images-combined-${Date.now()}.pdf`)}catch(t){console.error(t),alert(o("tools_ui.image_to_pdf.error_alert"))}finally{c(!1)}}};return e.jsx("div",{className:"space-y-8 max-w-5xl mx-auto",children:r.length===0?e.jsx(S,{onFilesSelected:p,accept:{"image/*":[".png",".jpg",".jpeg"]},multiple:!0}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 p-6 rounded-2xl border border-gray-100",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:[r.length," ",o("tools_ui.image_to_pdf.selected_images")]})}),e.jsxs(_,{sensors:h,collisionDetection:P,onDragEnd:b,onDragStart:t=>g(t.active.id),children:[e.jsx(F,{items:r.map(t=>t.id),strategy:C,children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:[r.map(t=>e.jsx($,{...t,fileName:t.file.name,onRemove:u},t.id)),e.jsxs("div",{className:"aspect-square flex items-center justify-center bg-gray-50 border-2 border-dashed border-gray-200 rounded-xl hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>document.getElementById("add-more-img")?.click(),children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{className:"text-xl",children:"+"})}),e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:o("tools_ui.image_to_pdf.add_images")})]}),e.jsx("input",{id:"add-more-img",type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:t=>{t.target.files&&p(Array.from(t.target.files))}})]})]})}),e.jsx(B,{children:m?e.jsx("div",{className:"aspect-square bg-white rounded-xl shadow-xl overflow-hidden opacity-90 cursor-grabbing border-2 border-blue-500",children:e.jsx("img",{src:r.find(t=>t.id===m)?.preview,className:"w-full h-full object-cover"})}):null})]})]}),e.jsx(w,{onClick:y,disabled:d,className:"w-full",isProcessing:d,icon:M,processingMessage:o("tools_ui.common.processing"),children:o("tools_ui.image_to_pdf.convert_button")})]})})}export{re as default};
