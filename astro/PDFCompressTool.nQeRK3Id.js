import{_ as L}from"./preload-helper.BlTxHScW.js";import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.BR1w_nJd.js";import{P as _}from"./PDFButton.Bm7otZl6.js";import{F as E}from"./fileUploader.D55Ta1Pr.js";import{F as T}from"./FileSaver.min.D-v3scGK.js";import{F as A}from"./file-text.DcW9pNJ8.js";import{X as I}from"./x.DlPzfmHM.js";import{L as M}from"./loader-circle.m7cZJHvs.js";import{M as R}from"./minimize-2.CWS4dmHY.js";import{C as q}from"./circle-check-big.Vx2QpGaZ.js";import{A as U}from"./arrow-down.BWPH-g_Y.js";import"./_commonjsHelpers.D6-XlEtG.js";import"./index.BUxk5OiF.js";import"./createLucideIcon._FvKnKwF.js";import"./utils.fNskMoFt.js";function le(){const[t,x]=o.useState(null),[p,g]=o.useState(!1),[y,n]=o.useState(0),[h,v]=o.useState(.7),[r,c]=o.useState(null),N=s=>{s.length>0&&(x(s[0]),c(null),n(0))},C=async()=>{if(t){g(!0),n(0);try{const s=await L(()=>import("./pdf.OfKI3oAY.js"),[]);s.GlobalWorkerOptions.workerSrc="/pdf.worker.min.mjs";const P=await t.arrayBuffer(),u=await s.getDocument({data:P}).promise,f=u.numPages,m=await _.create();for(let l=1;l<=f;l++){const w=await u.getPage(l),a=w.getViewport({scale:1.5}),i=document.createElement("canvas"),j=i.getContext("2d");if(i.height=a.height,i.width=a.width,j){await w.render({canvasContext:j,viewport:a}).promise;const D=i.toDataURL("image/jpeg",h),S=await fetch(D).then(B=>B.arrayBuffer()),z=await m.embedJpg(S);m.addPage([a.width,a.height]).drawImage(z,{x:0,y:0,width:a.width,height:a.height})}n(Math.round(l/f*100))}const k=await m.save(),b=new Blob([k],{type:"application/pdf"});c({blob:b,size:b.size})}catch(s){console.error("Compression failed:",s),alert(`Compression failed: ${s.message}`)}finally{g(!1)}}},F=()=>{r&&T.saveAs(r.blob,`compressed-${t?.name||"document.pdf"}`)},d=s=>(s/1024/1024).toFixed(2)+" MB";return e.jsx("div",{className:"max-w-4xl mx-auto space-y-8",children:t?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-gray-50 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 block",children:t.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",d(t.size),")"]})]})]}),e.jsx("button",{onClick:()=>{x(null),c(null)},className:"p-1.5 hover:bg-gray-200 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(I,{className:"w-4 h-4"})})]}),r?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(q,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Compression Complete!"}),e.jsxs("p",{className:"text-gray-500 mb-8",children:["Your file has been compressed from ",e.jsx("span",{className:"font-medium text-gray-900",children:d(t.size)})," to ",e.jsx("span",{className:"font-bold text-green-600",children:d(r.size)})]}),e.jsxs("button",{onClick:F,className:"px-8 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl font-bold shadow-lg shadow-green-500/20 flex items-center gap-2 mx-auto transition-all",children:[e.jsx(U,{className:"w-5 h-5"}),"Download Compressed PDF"]})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Compression Level"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{label:"Extreme",value:.4,desc:"Low quality, smallest size"},{label:"Recommended",value:.7,desc:"Good quality, good compression"},{label:"High Quality",value:.9,desc:"Best quality, larger size"}].map(s=>e.jsxs("button",{onClick:()=>v(s.value),className:`p-4 rounded-xl border-2 text-left transition-all ${h===s.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx("div",{className:"font-bold text-gray-900",children:s.label}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:s.desc})]},s.label))})]}),e.jsx("button",{onClick:C,disabled:p,className:"w-full py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-lg shadow-blue-500/20 flex items-center justify-center gap-2 transition-all disabled:opacity-70 disabled:cursor-not-allowed",children:p?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-5 h-5 animate-spin"}),"Compressing (",y,"%)..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-5 h-5"}),"Compress PDF"]})})]})]}):e.jsx(E,{onFilesSelected:N,accept:{"application/pdf":[".pdf"]}})})}export{le as default};
