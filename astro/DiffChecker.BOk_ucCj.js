import{u as e,r as t,j as r,e as l}from"./vendor.Ml7xHclh.js";import"./i18n.BsxyfPkU.js";import{G as s,g as a,A as o,R as n,h as d,C as i,i as c}from"./lucide-icons.CJY1ueNI.js";function h(){const{t:h}=e(),[g,x]=t.useState(""),[m,f]=t.useState(""),[b,p]=t.useState([]),[u,y]=t.useState({additions:0,removals:0}),[w,j]=t.useState({}),v=(e,t)=>{if(!e&&!t)return p([]),y({additions:0,removals:0}),void j({});const r=l(e,t),s=[];let a=1,o=1,n=0,d=0;for(let l=0;l<r.length;l++){const e=r[l],t=e.value.replace(/\n$/,"").split("\n");if(e.added){n+=e.count||0;let r=0;for(let e=s.length-1;e>=0&&"empty"===s[e].rightType&&"removed"===s[e].leftType;e--)r++;let l=s.length-r;const a=s.length;t.forEach(e=>{l<a?(s[l].rightContent=e,s[l].rightType="added",s[l].rightLineNumber=o++,l++):s.push({leftLineNumber:null,leftContent:null,leftType:"empty",rightLineNumber:o++,rightContent:e,rightType:"added"})})}else e.removed?(d+=e.count||0,t.forEach(e=>{s.push({leftLineNumber:a++,leftContent:e,leftType:"removed",rightLineNumber:null,rightContent:null,rightType:"empty"})})):t.forEach(e=>{s.push({leftLineNumber:a++,leftContent:e,leftType:"unchanged",rightLineNumber:o++,rightContent:e,rightType:"unchanged"})})}let i=0,c=!1;const h=s.map(e=>"unchanged"!==e.leftType||"unchanged"!==e.rightType?(c||(i++,c=!0),{...e,blockId:`block-${i}`}):(c=!1,e));p(h),y({additions:n,removals:d}),j({})},N=t.useMemo(()=>0===b.length?"":b.map(e=>"right"===(e.blockId&&w[e.blockId]||"right")?"empty"===e.rightType?null:e.rightContent:"empty"===e.leftType?null:e.leftContent).filter(e=>null!==e).join("\n"),[b,w]);return r.jsxs("div",{className:"max-w-[1600px] mx-auto p-4 sm:p-6 lg:p-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-8",children:[r.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[r.jsx(s,{className:"w-8 h-8 text-cyan-600"}),h("tools_ui.diff_checker.title")]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("button",{onClick:()=>{x(""),f(""),p([]),y({additions:0,removals:0}),j({})},className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[r.jsx(a,{className:"w-4 h-4"})," ",h("tools_ui.common.clear")]}),r.jsx("button",{onClick:()=>{x("function add(a, b) {\n  return a + b;\n}\nconsole.log(add(1, 2));"),f("function add(a, b) {\n  // Adding validation\n  if (typeof a !== 'number' || typeof b !== 'number') return 0;\n  return a + b;\n}\nconsole.log(add(1, 2));"),p([]),j({})},className:"px-4 py-2 text-sm font-medium text-cyan-600 bg-cyan-50 rounded-lg hover:bg-cyan-100 flex items-center gap-2",children:h("tools_ui.common.load_sample")})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 h-[300px] mb-8 relative items-center",children:[r.jsxs("div",{className:"flex flex-col border border-gray-200 rounded-xl overflow-hidden bg-white shadow-sm flex-1 h-full w-full",children:[r.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-100 flex justify-between items-center",children:r.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:h("tools_ui.diff_checker.original_label")})}),r.jsx("textarea",{className:"flex-grow p-4 outline-none resize-none font-mono text-xs leading-5 bg-white",value:g,onChange:e=>x(e.target.value),placeholder:h("tools_ui.diff_checker.original_placeholder"),spellCheck:!1})]}),r.jsx("button",{onClick:()=>{const e=m,t=g;x(e),f(t),v(e,t)},className:"p-2 bg-white border border-gray-200 rounded-full shadow-sm hover:bg-gray-50 hover:text-cyan-600 transition-colors z-10 md:absolute md:left-1/2 md:top-1/2 md:-translate-x-1/2 md:-translate-y-1/2",title:"Swap Inputs",children:r.jsx(o,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex flex-col border border-gray-200 rounded-xl overflow-hidden bg-white shadow-sm flex-1 h-full w-full",children:[r.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-100 flex justify-between items-center",children:r.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:h("tools_ui.diff_checker.modified_label")})}),r.jsx("textarea",{className:"flex-grow p-4 outline-none resize-none font-mono text-xs leading-5 bg-white",value:m,onChange:e=>f(e.target.value),placeholder:h("tools_ui.diff_checker.modified_placeholder"),spellCheck:!1})]})]}),r.jsx("div",{className:"flex justify-center mb-8",children:r.jsxs("button",{onClick:()=>{v(g,m)},className:"flex items-center gap-2 px-8 py-3 bg-cyan-600 text-white font-semibold rounded-xl hover:bg-cyan-700 transition-colors shadow-lg shadow-cyan-600/20 text-lg",children:[r.jsx(s,{className:"w-5 h-5"})," ",h("tools_ui.diff_checker.find_diff")]})}),b.length>0&&r.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden bg-white shadow-sm mb-12",children:[r.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200 flex justify-between items-center flex-wrap gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("span",{className:"text-xs font-bold text-gray-700 uppercase tracking-wider",children:h("tools_ui.diff_checker.result_title")}),r.jsxs("div",{className:"flex gap-2",children:[u.removals>0&&r.jsxs("span",{className:"text-xs font-bold text-red-600 bg-red-50 px-2 py-0.5 rounded-full border border-red-100",children:["-",u.removals," removals"]}),u.additions>0&&r.jsxs("span",{className:"text-xs font-bold text-green-600 bg-green-50 px-2 py-0.5 rounded-full border border-green-100",children:["+",u.additions," additions"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[r.jsxs("button",{onClick:()=>{const e={};b.forEach(t=>t.blockId&&(e[t.blockId]="left")),j(e)},className:"px-3 py-1.5 text-xs font-medium bg-white text-gray-700 border border-gray-200 rounded-md hover:bg-gray-50 hover:border-gray-300 transition-colors flex items-center gap-1.5 shadow-sm",children:[r.jsx(n,{className:"w-3.5 h-3.5"})," ",h("tools_ui.diff_checker.revert_all")]}),r.jsxs("button",{onClick:()=>{j({})},className:"px-3 py-1.5 text-xs font-medium bg-white text-gray-700 border border-gray-200 rounded-md hover:bg-gray-50 hover:border-gray-300 transition-colors flex items-center gap-1.5 shadow-sm",children:[r.jsx(d,{className:"w-3.5 h-3.5"})," ",h("tools_ui.diff_checker.accept_all")]}),r.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),r.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(N)},className:"px-4 py-1.5 text-xs font-bold bg-cyan-600 text-white rounded-md hover:bg-cyan-700 flex items-center gap-1.5 shadow-sm shadow-cyan-600/20",children:[r.jsx(i,{className:"w-3.5 h-3.5"})," ",h("tools_ui.diff_checker.copy_merged")]})]})]}),r.jsx("div",{className:"font-mono text-xs leading-5 overflow-x-auto",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsxs("colgroup",{children:[r.jsx("col",{width:"40px"}),r.jsx("col",{width:"50%"}),r.jsx("col",{width:"50px"}),r.jsx("col",{width:"40px"}),r.jsx("col",{width:"50%"})]}),r.jsx("tbody",{children:b.map((e,t)=>{const l=e.blockId,s=l&&w[l]||"right",a="unchanged"!==e.leftType||"unchanged"!==e.rightType,o=l&&(0===t||b[t-1].blockId!==l);let n=e.rightContent,d=e.rightType;return"left"===s&&a&&(n=e.leftContent,d="removed"===e.leftType?"removed":"unchanged"),r.jsxs("tr",{className:"border-b border-gray-50 last:border-0 hover:bg-gray-50/50 group",children:[r.jsx("td",{className:"text-right pr-3 select-none text-gray-400 border-r border-gray-100 "+("removed"===e.leftType?"bg-red-50":"bg-white"),children:e.leftLineNumber}),r.jsx("td",{className:`pl-2 pr-2 whitespace-pre-wrap break-all ${"removed"===e.leftType?"bg-red-50 text-red-900":"text-gray-600"} ${"right"===s&&a?"opacity-60":""}`,children:e.leftContent||" "}),r.jsx("td",{className:"text-center bg-gray-50/30 border-l border-r border-gray-100 p-0 align-middle",children:o&&r.jsx("button",{onClick:()=>l&&(e=>{j(t=>{const r=t[e]||"right";return{...t,[e]:"right"===r?"left":"right"}})})(l),className:"w-6 h-6 rounded-full flex items-center justify-center transition-all shadow-sm mx-auto "+("left"===s?"bg-green-600 text-white ring-2 ring-green-100 scale-110":"bg-white border border-gray-200 text-gray-400 hover:text-green-600 hover:border-green-300"),title:h("left"===s?"tools_ui.diff_checker.status_reverted":"tools_ui.diff_checker.status_modified"),children:r.jsx(c,{className:"w-3.5 h-3.5"})})}),r.jsx("td",{className:"text-right pr-3 select-none text-gray-400 border-r border-gray-100 "+("added"===d?"bg-green-50":"bg-white"),children:e.rightLineNumber}),r.jsx("td",{className:"pl-2 pr-2 whitespace-pre-wrap break-all "+("added"===d?"bg-green-50 text-green-900":"text-gray-600"),children:n||" "})]},t)})})]})})]})]})}export{h as default};
