import{j as e}from"./createLucideIcon.CH-mSxXv.js";import{r as j}from"./index.BR1w_nJd.js";import{P as v}from"./PDFButton.Bm7otZl6.js";import{F as N}from"./fileUploader.BLbgfAQx.js";import{F as S}from"./FileSaver.min.D-v3scGK.js";import{u as D,a as y,D as I,c as _,S as P,r as C,b as F,s as A,K as B,P as E,d as R,e as T,C as L}from"./sortable.esm.B22XIUkC.js";import"./i18n.D5xAk-hA.js";import{u as k}from"./useTranslation.C-NthtKk.js";import{L as q}from"./loader-circle.D30OAAi7.js";import{A as K}from"./arrow-down.3Luxqwhg.js";import{X as U}from"./x.PcIF29Xl.js";import"./_commonjsHelpers.D6-XlEtG.js";import"./index.CeYlJSet.js";import"./utils.fNskMoFt.js";import"./index.B80MxM07.js";function $({id:n,preview:r,fileName:l,onRemove:d}){const{attributes:c,listeners:m,setNodeRef:g,transform:h,transition:p,isDragging:u}=T({id:n}),b={transform:L.Transform.toString(h),transition:p,zIndex:u?10:1,opacity:u?.5:1};return e.jsxs("div",{ref:g,style:b,...c,...m,className:"group relative aspect-square bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow cursor-grab active:cursor-grabbing",children:[e.jsx("img",{src:r,alt:l,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onPointerDown:w=>{w.stopPropagation(),d(n)},className:"p-1 bg-red-500 text-white rounded-full hover:bg-red-600 shadow-sm",children:e.jsx(U,{className:"w-3 h-3"})})})]})}function re(){const{t:n}=k(),[r,l]=j.useState([]),[d,c]=j.useState(!1),[m,g]=j.useState(null),h=D(y(E),y(B,{coordinateGetter:A})),p=t=>{const o=t.map(s=>({id:`img-${Date.now()}-${Math.random()}`,file:s,preview:URL.createObjectURL(s)}));l(s=>[...s,...o])},u=t=>{l(o=>o.filter(s=>s.id!==t))},b=t=>{const{active:o,over:s}=t;o.id!==s.id&&l(i=>{const f=i.findIndex(x=>x.id===o.id),a=i.findIndex(x=>x.id===s.id);return R(i,f,a)}),g(null)},w=async()=>{if(r.length!==0){c(!0);try{const t=await v.create();for(const i of r){const f=await i.file.arrayBuffer();let a;if(i.file.type==="image/jpeg"||i.file.type==="image/jpg")a=await t.embedJpg(f);else if(i.file.type==="image/png")a=await t.embedPng(f);else continue;t.addPage([a.width,a.height]).drawImage(a,{x:0,y:0,width:a.width,height:a.height})}const o=await t.save(),s=new Blob([o],{type:"application/pdf"});S.saveAs(s,`images-combined-${Date.now()}.pdf`)}catch(t){console.error(t),alert(n("tools_ui.image_to_pdf.error_alert"))}finally{c(!1)}}};return e.jsx("div",{className:"space-y-8 max-w-5xl mx-auto",children:r.length===0?e.jsx(N,{onFilesSelected:p,accept:{"image/*":[".png",".jpg",".jpeg"]},multiple:!0}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 p-6 rounded-2xl border border-gray-100",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:[r.length," ",n("tools_ui.image_to_pdf.selected_images")]})}),e.jsxs(I,{sensors:h,collisionDetection:_,onDragEnd:b,onDragStart:t=>g(t.active.id),children:[e.jsx(P,{items:r.map(t=>t.id),strategy:C,children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:[r.map(t=>e.jsx($,{...t,fileName:t.file.name,onRemove:u},t.id)),e.jsxs("div",{className:"aspect-square flex items-center justify-center bg-gray-50 border-2 border-dashed border-gray-200 rounded-xl hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>document.getElementById("add-more-img")?.click(),children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{className:"text-xl",children:"+"})}),e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:n("tools_ui.image_to_pdf.add_images")})]}),e.jsx("input",{id:"add-more-img",type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:t=>{t.target.files&&p(Array.from(t.target.files))}})]})]})}),e.jsx(F,{children:m?e.jsx("div",{className:"aspect-square bg-white rounded-xl shadow-xl overflow-hidden opacity-90 cursor-grabbing border-2 border-blue-500",children:e.jsx("img",{src:r.find(t=>t.id===m)?.preview,className:"w-full h-full object-cover"})}):null})]})]}),e.jsxs("button",{onClick:w,disabled:d,className:"w-full py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-lg shadow-blue-500/20 flex items-center justify-center gap-2 transition-all",children:[d?e.jsx(q,{className:"animate-spin w-5 h-5"}):e.jsx(K,{className:"w-5 h-5"}),n("tools_ui.image_to_pdf.convert_button")]})]})})}export{re as default};
