import{u as e,r as s,o as a,q as t,j as i,D as r,t as o,S as n,v as l,w as d,y as c,K as m,P as g,x as p,F as u,G as f,H as h}from"./vendor.Ml7xHclh.js";import{P as x}from"./pdf-vendor.5vxXXNST.js";import{F as j}from"./fileUploader.B1Dwo65Z.js";import{P as b}from"./ProcessButton.mPdpvfTx.js";import"./i18n.BsxyfPkU.js";import{v,X as w}from"./lucide-icons.CJY1ueNI.js";import"./utils.Ceoo1Swf.js";function y({id:e,preview:s,fileName:a,onRemove:t}){const{attributes:r,listeners:o,setNodeRef:n,transform:l,transition:d,isDragging:c}=f({id:e}),m={transform:h.Transform.toString(l),transition:d,zIndex:c?10:1,opacity:c?.5:1};return i.jsxs("div",{ref:n,style:m,...r,...o,className:"group relative aspect-square bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow cursor-grab active:cursor-grabbing",children:[i.jsx("img",{src:s,alt:a,className:"w-full h-full object-cover"}),i.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx("button",{onPointerDown:s=>{s.stopPropagation(),t(e)},className:"p-1 bg-red-500 text-white rounded-full hover:bg-red-600 shadow-sm",children:i.jsx(w,{className:"w-3 h-3"})})})]})}function N(){const{t:f}=e(),[h,w]=s.useState([]),[N,_]=s.useState(!1),[D,P]=s.useState(null),S=a(t(g),t(m,{coordinateGetter:c})),B=e=>{const s=e.map(e=>({id:`img-${Date.now()}-${Math.random()}`,file:e,preview:URL.createObjectURL(e)}));w(e=>[...e,...s])},I=e=>{w(s=>s.filter(s=>s.id!==e))};return i.jsx("div",{className:"space-y-8 max-w-5xl mx-auto",children:0===h.length?i.jsx(j,{onFilesSelected:B,accept:{"image/*":[".png",".jpg",".jpeg"]},multiple:!0}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-gray-50 p-6 rounded-2xl border border-gray-100",children:[i.jsx("div",{className:"flex justify-between items-center mb-6",children:i.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:[h.length," ",f("tools_ui.image_to_pdf.selected_images")]})}),i.jsxs(r,{sensors:S,collisionDetection:o,onDragEnd:e=>{const{active:s,over:a}=e;s.id!==a.id&&w(e=>{const t=e.findIndex(e=>e.id===s.id),i=e.findIndex(e=>e.id===a.id);return p(e,t,i)}),P(null)},onDragStart:e=>P(e.active.id),children:[i.jsx(n,{items:h.map(e=>e.id),strategy:l,children:i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:[h.map(e=>i.jsx(y,{...e,fileName:e.file.name,onRemove:I},e.id)),i.jsxs("div",{className:"aspect-square flex items-center justify-center bg-gray-50 border-2 border-dashed border-gray-200 rounded-xl hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>document.getElementById("add-more-img")?.click(),children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-2",children:i.jsx("span",{className:"text-xl",children:"+"})}),i.jsx("span",{className:"text-xs text-gray-500 font-medium",children:f("tools_ui.image_to_pdf.add_images")})]}),i.jsx("input",{id:"add-more-img",type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:e=>{e.target.files&&B(Array.from(e.target.files))}})]})]})}),i.jsx(d,{children:D?i.jsx("div",{className:"aspect-square bg-white rounded-xl shadow-xl overflow-hidden opacity-90 cursor-grabbing border-2 border-blue-500",children:i.jsx("img",{src:h.find(e=>e.id===D)?.preview,className:"w-full h-full object-cover"})}):null})]})]}),i.jsx(b,{onClick:async()=>{if(0!==h.length){_(!0);try{const e=await x.create();for(const t of h){const s=await t.file.arrayBuffer();let a;if("image/jpeg"===t.file.type||"image/jpg"===t.file.type)a=await e.embedJpg(s);else{if("image/png"!==t.file.type)continue;a=await e.embedPng(s)}e.addPage([a.width,a.height]).drawImage(a,{x:0,y:0,width:a.width,height:a.height})}const s=await e.save(),a=new Blob([s],{type:"application/pdf"});u.saveAs(a,`images-combined-${Date.now()}.pdf`)}catch(e){alert(f("tools_ui.image_to_pdf.error_alert"))}finally{_(!1)}}},disabled:N,className:"w-full",isProcessing:N,icon:v,processingMessage:f("tools_ui.common.processing"),children:f("tools_ui.image_to_pdf.convert_button")})]})})}export{N as default};
