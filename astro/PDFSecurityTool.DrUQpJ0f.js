const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["astro/pdf-vendor.5vxXXNST.js","astro/vendor.Ml7xHclh.js"])))=>i.map(i=>d[i]);
import{r as e,j as s,_ as a,F as t}from"./vendor.Ml7xHclh.js";import{P as r}from"./pdf-vendor.5vxXXNST.js";import{F as l}from"./fileUploader.B1Dwo65Z.js";import{u as o,f as n,p as c}from"./pdf.BjHsYDCh.js";import{P as i}from"./ProcessButton.mPdpvfTx.js";import{q as d,r as m,a6 as x,a7 as p,X as g,a2 as u,a8 as h,E as f,D as y}from"./lucide-icons.CJY1ueNI.js";import"./utils.Ceoo1Swf.js";function b(){const{files:b,addFiles:w,clearFiles:j,isProcessing:k,processingProgress:N,processingMessage:v,setProcessingState:P}=o({multiple:!1}),[F,D]=e.useState("lock"),[E,C]=e.useState(""),[S,U]=e.useState(!1),[B,_]=e.useState(null),[A,L]=e.useState(null),[T,$]=e.useState(!0),I=b[0]||null;return s.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[s.jsx("div",{className:"flex justify-center mb-8",children:s.jsxs("div",{className:"bg-white p-1 rounded-xl shadow-sm border border-gray-200 inline-flex",children:[s.jsxs("button",{onClick:()=>{D("lock"),j(),_(null)},className:"px-6 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 transition-all "+("lock"===F?"bg-rose-50 text-rose-700 shadow-sm ring-1 ring-rose-200":"text-gray-600 hover:bg-gray-50"),children:[s.jsx(d,{className:"w-4 h-4"})," Lock PDF"]}),s.jsxs("button",{onClick:()=>{D("unlock"),j(),_(null)},className:"px-6 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 transition-all "+("unlock"===F?"bg-emerald-50 text-emerald-700 shadow-sm ring-1 ring-emerald-200":"text-gray-600 hover:bg-gray-50"),children:[s.jsx(m,{className:"w-4 h-4"})," Unlock PDF"]})]})}),I?s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-gray-50 border border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-3",children:["lock"===F?s.jsx(x,{className:"w-5 h-5 text-rose-500"}):s.jsx(p,{className:"w-5 h-5 text-emerald-500"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-700 block",children:I.name}),s.jsxs("span",{className:"text-xs text-gray-400",children:["(",n(I.size),")"]})]})]}),s.jsx("button",{onClick:()=>{j(),_(null)},className:"p-1.5 hover:bg-gray-200 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(g,{className:"w-4 h-4"})})]}),B?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(f,{className:"w-8 h-8"})}),s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"lock"===F?"File Protected!":"File Unlocked!"}),s.jsx("p",{className:"text-gray-500 mb-8",children:"Your file is ready for download."}),s.jsxs("button",{onClick:()=>{if(B&&I){const e="lock"===F?"protected":"unlocked";t.saveAs(B,`${e}-${I.name}`)}},className:"px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold shadow-lg shadow-blue-500/20 flex items-center gap-2 mx-auto transition-all",children:[s.jsx(y,{className:"w-5 h-5"}),"Download ","lock"===F?"Protected":"Unlocked"," PDF"]})]}):s.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"lock"===F?"Set Password":"Enter Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:S?"text":"password",value:E,onChange:e=>C(e.target.value),placeholder:"lock"===F?"Enter a strong password":"Enter the PDF password",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all pr-12"}),s.jsx("button",{type:"button",onClick:()=>U(!S),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 focus:outline-none",children:S?s.jsx(u,{className:"w-5 h-5"}):s.jsx(h,{className:"w-5 h-5"})})]}),A&&s.jsxs("div",{className:"text-rose-500 text-sm mt-2 flex items-center gap-1",children:[s.jsx(x,{className:"w-3 h-3"})," ",A]})]}),"unlock"===F&&s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",id:"force-mode",checked:T,onChange:e=>$(e.target.checked),className:"mt-1 w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),s.jsxs("label",{htmlFor:"force-mode",className:"text-sm text-gray-700 cursor-pointer",children:[s.jsx("span",{className:"font-semibold block text-gray-900",children:"Force Unlock (Flatten PDF)"}),s.jsx("span",{className:"text-gray-500",children:"Enable this if regular unlocking fails (e.g. for Aadhaar or Bank Statements). Converts pages to images."})]})]}),s.jsx(i,{onClick:async()=>{if(I&&E){P(!0,"lock"===F?"Encrypting...":"Decrypting..."),L(null);try{const s=await I.arrayBuffer();if("lock"===F)try{const{encryptPDF:e}=await a(async()=>{const{encryptPDF:e}=await import("./pdf-vendor.5vxXXNST.js").then(e=>e.i);return{encryptPDF:e}},__vite__mapDeps([0,1])),t=await e(new Uint8Array(s),E,E);_(new Blob([t],{type:"application/pdf"}))}catch(e){if(e.message&&e.message.includes("Encrypted"))throw new Error("This PDF is already encrypted. Please unlock it first.");throw e}else if(T){const e=await c(s,E,e=>{P(!0,"Processing...",e)});_(new Blob([e],{type:"application/pdf"}))}else try{const e=await r.load(s,{password:E,ignoreEncryption:!1}),a=await e.save();_(new Blob([a],{type:"application/pdf"}))}catch(e){if(e.message&&e.message.toLowerCase().includes("password"))throw new Error("Incorrect password. Please try again.");if(e.message&&(e.message.includes("Unsupported")||e.message.includes("Encrypted")))throw new Error("This PDF uses advanced encryption. Please try checking 'Force Unlock (Flatten PDF)' below.");throw new Error(`Unlock failed: ${e.message}`)}}catch(s){L(s.message||"Operation failed. Please try a different file.")}finally{P(!1)}}},disabled:!E,isProcessing:k,progress:N,processingMessage:v,className:"lock"===F?"bg-rose-600 hover:bg-rose-700 text-white shadow-rose-500/20":"bg-emerald-600 hover:bg-emerald-700 text-white shadow-emerald-500/20",icon:"lock"===F?d:m,children:"lock"===F?"Protect PDF":"Unlock PDF"})]})]}):s.jsx(l,{onFilesSelected:e=>{w(e),_(null),L(null),C(""),$(!0)},accept:{"application/pdf":[".pdf"]}})]})}export{b as default};
