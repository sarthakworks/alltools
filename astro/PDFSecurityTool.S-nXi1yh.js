const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["astro/index.B2793EkL.js","astro/_commonjsHelpers.D6-XlEtG.js","astro/ProcessButton.CVFw6SxZ.js","astro/jsx-runtime.D_zvdyIk.js","astro/index.BR1w_nJd.js","astro/utils.DXMiVD0-.js","astro/loader-circle.m7cZJHvs.js","astro/createLucideIcon._FvKnKwF.js"])))=>i.map(i=>d[i]);
import{_ as B}from"./preload-helper.BlTxHScW.js";import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as c}from"./index.BR1w_nJd.js";import{P as L,a as M}from"./ProcessButton.CVFw6SxZ.js";import{F as A}from"./fileUploader.e1Ms2KWN.js";import{F as $}from"./FileSaver.min.D-v3scGK.js";import{u as z,f as T,p as O}from"./pdf.DIkd52Y_.js";import{L as w}from"./lock.BwDUyFyp.js";import{L as k}from"./lock-open.C6CnV6Zx.js";import{c as u}from"./createLucideIcon._FvKnKwF.js";import{X as I}from"./x.DlPzfmHM.js";import{E as V}from"./eye-off.sf0NPTJb.js";import{C as R}from"./circle-check-big.Vx2QpGaZ.js";import{D as X}from"./download.WYS23KZw.js";import"./_commonjsHelpers.D6-XlEtG.js";import"./utils.DXMiVD0-.js";import"./loader-circle.m7cZJHvs.js";import"./index.BUxk5OiF.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],q=u("eye",Y);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],j=u("shield-alert",G);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],J=u("shield-check",H);function ue(){const{files:N,addFiles:F,clearFiles:i,isProcessing:P,processingProgress:v,processingMessage:D,setProcessingState:d}=z({multiple:!1}),[t,h]=c.useState("lock"),[a,f]=c.useState(""),[m,E]=c.useState(!1),[p,o]=c.useState(null),[g,x]=c.useState(null),[y,b]=c.useState(!0),l=N[0]||null,C=r=>{F(r),o(null),x(null),f(""),b(!0)},S=async()=>{if(!(!l||!a)){d(!0,t==="lock"?"Encrypting...":"Decrypting..."),x(null);try{const r=await l.arrayBuffer();if(t==="lock")try{const{encryptPDF:s}=await B(async()=>{const{encryptPDF:U}=await import("./index.B2793EkL.js");return{encryptPDF:U}},__vite__mapDeps([0,1,2,3,4,5,6,7])),n=await s(new Uint8Array(r),a,a);o(new Blob([n],{type:"application/pdf"}))}catch(s){throw s.message&&s.message.includes("Encrypted")?new Error("This PDF is already encrypted. Please unlock it first."):s}else if(y){const s=await O(r,a,n=>{d(!0,"Processing...",n)});o(new Blob([s],{type:"application/pdf"}))}else try{const n=await(await M.load(r,{password:a,ignoreEncryption:!1})).save();o(new Blob([n],{type:"application/pdf"}))}catch(s){throw console.error("Unlock failed:",s),s.message&&s.message.toLowerCase().includes("password")?new Error("Incorrect password. Please try again."):s.message&&(s.message.includes("Unsupported")||s.message.includes("Encrypted"))?new Error("This PDF uses advanced encryption. Please try checking 'Force Unlock (Flatten PDF)' below."):new Error(`Unlock failed: ${s.message}`)}}catch(r){console.error("Security operation failed:",r),x(r.message||"Operation failed. Please try a different file.")}finally{d(!1)}}},_=()=>{if(p&&l){const r=t==="lock"?"protected":"unlocked";$.saveAs(p,`${r}-${l.name}`)}};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs("div",{className:"bg-white p-1 rounded-xl shadow-sm border border-gray-200 inline-flex",children:[e.jsxs("button",{onClick:()=>{h("lock"),i(),o(null)},className:`px-6 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 transition-all ${t==="lock"?"bg-rose-50 text-rose-700 shadow-sm ring-1 ring-rose-200":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(w,{className:"w-4 h-4"})," Lock PDF"]}),e.jsxs("button",{onClick:()=>{h("unlock"),i(),o(null)},className:`px-6 py-2 rounded-lg text-sm font-semibold flex items-center gap-2 transition-all ${t==="unlock"?"bg-emerald-50 text-emerald-700 shadow-sm ring-1 ring-emerald-200":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(k,{className:"w-4 h-4"})," Unlock PDF"]})]})}),l?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-gray-50 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t==="lock"?e.jsx(j,{className:"w-5 h-5 text-rose-500"}):e.jsx(J,{className:"w-5 h-5 text-emerald-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 block",children:l.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",T(l.size),")"]})]})]}),e.jsx("button",{onClick:()=>{i(),o(null)},className:"p-1.5 hover:bg-gray-200 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(I,{className:"w-4 h-4"})})]}),p?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(R,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:t==="lock"?"File Protected!":"File Unlocked!"}),e.jsx("p",{className:"text-gray-500 mb-8",children:"Your file is ready for download."}),e.jsxs("button",{onClick:_,className:"px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold shadow-lg shadow-blue-500/20 flex items-center gap-2 mx-auto transition-all",children:[e.jsx(X,{className:"w-5 h-5"}),"Download ",t==="lock"?"Protected":"Unlocked"," PDF"]})]}):e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t==="lock"?"Set Password":"Enter Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:m?"text":"password",value:a,onChange:r=>f(r.target.value),placeholder:t==="lock"?"Enter a strong password":"Enter the PDF password",className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all pr-12"}),e.jsx("button",{type:"button",onClick:()=>E(!m),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 focus:outline-none",children:m?e.jsx(V,{className:"w-5 h-5"}):e.jsx(q,{className:"w-5 h-5"})})]}),g&&e.jsxs("div",{className:"text-rose-500 text-sm mt-2 flex items-center gap-1",children:[e.jsx(j,{className:"w-3 h-3"})," ",g]})]}),t==="unlock"&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"force-mode",checked:y,onChange:r=>b(r.target.checked),className:"mt-1 w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),e.jsxs("label",{htmlFor:"force-mode",className:"text-sm text-gray-700 cursor-pointer",children:[e.jsx("span",{className:"font-semibold block text-gray-900",children:"Force Unlock (Flatten PDF)"}),e.jsx("span",{className:"text-gray-500",children:"Enable this if regular unlocking fails (e.g. for Aadhaar or Bank Statements). Converts pages to images."})]})]}),e.jsx(L,{onClick:S,disabled:!a,isProcessing:P,progress:v,processingMessage:D,className:t==="lock"?"bg-rose-600 hover:bg-rose-700 text-white shadow-rose-500/20":"bg-emerald-600 hover:bg-emerald-700 text-white shadow-emerald-500/20",icon:t==="lock"?w:k,children:t==="lock"?"Protect PDF":"Unlock PDF"})]})]}):e.jsx(A,{onFilesSelected:C,accept:{"application/pdf":[".pdf"]}})]})}export{ue as default};
