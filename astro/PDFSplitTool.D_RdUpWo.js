import{r as e,o as s,q as a,j as t,D as i,t as r,S as n,v as l,w as c,y as o,K as d,P as g,x as p,F as f}from"./vendor.Ml7xHclh.js";import{P as m,J as x}from"./pdf-vendor.5vxXXNST.js";import{F as h}from"./fileUploader.B1Dwo65Z.js";import{u,g as j}from"./pdf.BjHsYDCh.js";import{P as y}from"./ProcessButton.mPdpvfTx.js";import{D as v}from"./DraggablePage.BjWmOmmx.js";import{$ as b,o as w,t as N}from"./lucide-icons.CJY1ueNI.js";import"./utils.Ceoo1Swf.js";function P(){const{files:P,addFiles:D,filesRef:I,isProcessing:S,processingMessage:E,setProcessingState:$}=u({multiple:!0}),[F,C]=e.useState([]),[M,A]=e.useState(null),B=s(a(g),a(d,{coordinateGetter:o})),k=async e=>{const s=I.current.length;D(e),$(!0,"Generating thumbnails...");try{const t=[];for(let i=0;i<e.length;i++){const r=e[i];$(!0,`Processing ${r.name}...`,Math.round((i+1)/e.length*100));try{(await j(r)).forEach((e,a)=>{t.push({id:`f${s+i}-p${a+1}-${Date.now()}-${Math.random()}`,fileIndex:s+i,pageIndex:a,image:e,fileName:r.name})})}catch(a){}}C(e=>[...e,...t])}catch(t){alert(`Error: ${t.message}`)}finally{$(!1)}},_=e=>{C(s=>s.filter(s=>s.id!==e))};return t.jsxs("div",{className:"space-y-8",children:[P.length>0&&t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 p-4 bg-gray-50 rounded-xl border border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(b,{className:"w-5 h-5 text-gray-500"}),t.jsx("span",{className:"font-medium text-gray-700",children:"Split & Organize Mode"})]}),t.jsxs("div",{className:"text-sm text-gray-500",children:[F.length," pages selected"]})]}),t.jsx("div",{className:"min-h-75",children:0===P.length?t.jsx(h,{onFilesSelected:k,accept:{"application/pdf":[".pdf"]},multiple:!0,title:"Upload PDF to Split"}):t.jsx("div",{className:"space-y-6",children:t.jsxs(i,{sensors:B,collisionDetection:r,onDragEnd:e=>{const{active:s,over:a}=e;s.id!==a.id&&C(e=>{const t=e.findIndex(e=>e.id===s.id),i=e.findIndex(e=>e.id===a.id);return p(e,t,i)}),A(null)},onDragStart:e=>A(e.active.id),children:[t.jsx(n,{items:F.map(e=>e.id),strategy:l,children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:[F.map(e=>t.jsx(v,{...e,onRemove:_},e.id)),t.jsxs("div",{className:"aspect-3/4 flex items-center justify-center bg-gray-50 border-2 border-dashed border-gray-200 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>document.getElementById("add-more-pdf-split")?.click(),children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-2",children:t.jsx("span",{className:"text-xl",children:"+"})}),t.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Add More"})]}),t.jsx("input",{id:"add-more-pdf-split",type:"file",multiple:!0,accept:".pdf",className:"hidden",onChange:e=>{e.target.files&&k(Array.from(e.target.files))}})]})]})}),t.jsx(c,{children:M?t.jsx("div",{className:"aspect-3/4 bg-white rounded-lg shadow-xl overflow-hidden opacity-90 cursor-grabbing border-2 border-blue-500",children:t.jsx("img",{src:F.find(e=>e.id===M)?.image,className:"w-full h-full object-contain p-2"})}):null})]})})}),P.length>0&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(y,{onClick:async()=>{if(0!==F.length){$(!0,"Creating PDF...");try{const e=await m.create(),s=[...new Set(F.map(e=>e.fileIndex))],a={},t=I.current;for(const n of s){if(!t[n])continue;const e=await t[n].arrayBuffer();a[n]=await m.load(e)}for(const n of F){if(!a[n.fileIndex])continue;const s=a[n.fileIndex],[t]=await e.copyPages(s,[n.pageIndex]);e.addPage(t)}const i=await e.save(),r=new Blob([i],{type:"application/pdf"});f.saveAs(r,`splitted-rearranged-${Date.now()}.pdf`)}catch(e){alert("Error saving PDF")}finally{$(!1)}}},disabled:S,isProcessing:S&&"Creating PDF..."===E,icon:w,processingMessage:"Saving...",progress:S?100:0,children:"Save as Single PDF"}),t.jsx(y,{onClick:async()=>{if(0!==F.length){$(!0,"Extracting pages...");try{const e=new x,s=[...new Set(F.map(e=>e.fileIndex))],a={},t=I.current;for(const r of s){if(!t[r])continue;const e=await t[r].arrayBuffer();a[r]=await m.load(e)}for(let r=0;r<F.length;r++){const s=F[r];if(!a[s.fileIndex])continue;const t=a[s.fileIndex],i=await m.create(),[n]=await i.copyPages(t,[s.pageIndex]);i.addPage(n);const l=await i.save();e.file(`Page_${r+1}_${s.fileName}`,l)}const i=await e.generateAsync({type:"blob"});f.saveAs(i,`extracted_pages_${Date.now()}.zip`)}catch(e){alert("Error extracting pages")}finally{$(!1)}}},disabled:S,isProcessing:S&&"Extracting pages..."===E,icon:N,processingMessage:"Extracting...",className:"bg-purple-600 hover:bg-purple-700 shadow-purple-500/20",children:"Extract All as ZIP"})]})]})}export{P as default};
