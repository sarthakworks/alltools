import{C as e,u as s,r as t,j as r}from"./vendor.Ml7xHclh.js";import"./i18n.BsxyfPkU.js";import{q as a,C as l,r as o}from"./lucide-icons.CJY1ueNI.js";const n={CBC:e.mode.CBC,ECB:e.mode.ECB,CFB:e.mode.CFB,OFB:e.mode.OFB,CTR:e.mode.CTR},i={PKCS5:e.pad.Pkcs7,Pkcs7:e.pad.Pkcs7,Iso97971:e.pad.Iso97971,AnsiX923:e.pad.AnsiX923,Iso10126:e.pad.Iso10126,ZeroPadding:e.pad.ZeroPadding,NoPadding:e.pad.NoPadding},d={text:"",mode:"CBC",padding:"Pkcs7",iv:"",keySize:"128",secret:"",format:"Base64",inputFormat:"Base64",output:"",error:"",keyType:"Utf8"};function c(){const{t:c}=s(),[m,u]=t.useState({...d}),[p,g]=t.useState({...d,format:"Utf8"}),h=s=>{const t=s?m:p,r=s?u:g;if(r(e=>({...e,error:"",output:""})),t.text&&t.secret)try{const a={mode:n[t.mode],padding:i[t.padding]};t.iv&&"ECB"!==t.mode&&(a.iv=e.enc.Utf8.parse(t.iv));let l,o=t.secret;if("Utf8"===t.keyType&&(o=e.enc.Utf8.parse(t.secret)),s){const s=e.AES.encrypt(t.text,o,a);l="Base64"===t.format?s.toString():s.ciphertext.toString(e.enc.Hex)}else{let s=t.text;"Hex"===t.inputFormat&&(s={ciphertext:e.enc.Hex.parse(t.text.replace(/\s/g,""))});const r=e.AES.decrypt(s,o,a),n=r.toString(e.enc.Utf8);l="Base64"===t.format?r.toString(e.enc.Base64):n,!l&&r.sigBytes>0&&t.format}!l&&t.text,r(e=>({...e,output:l}))}catch(a){let e=a.message||"Operation failed.";e=e.includes("Malformed UTF-8")?c("tools_ui.aes_tool.error_malformed"):e.toLowerCase().includes("cannot read properties of undefined")?c("tools_ui.aes_tool.error_config"):"Operation failed."===e?c("tools_ui.aes_tool.error_operation"):a.message||"Operation failed.",r(s=>({...s,error:e}))}else r(e=>({...e,error:c("tools_ui.aes_tool.validation_error")}))},b=(e,s,t)=>{e(e=>({...e,[s]:t}))},f=e=>{navigator.clipboard.writeText(e)};return r.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6 lg:p-8",children:[r.jsxs("div",{className:"text-center mb-10",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 sm:text-4xl mb-4",children:c("tools_ui.aes_tool.title")}),r.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:c("tools_ui.aes_tool.subtitle")})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsx("div",{className:"bg-blue-50/50 px-6 py-4 border-b border-blue-100 flex items-center justify-between",children:r.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[r.jsx(a,{className:"w-5 h-5 text-blue-600"})," ",c("tools_ui.aes_tool.encrypt_title")]})}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c("tools_ui.aes_tool.encrypt_input_label")}),r.jsx("textarea",{className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all outline-none resize-y min-h-30",placeholder:c("tools_ui.aes_tool.input_placeholder"),value:m.text,onChange:e=>b(u,"text",e.target.value)})]}),r.jsx(x,{prefix:"enc",state:m,setter:u}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c("tools_ui.aes_tool.output_format")}),r.jsx("div",{className:"flex gap-4",children:["Base64","Hex"].map(e=>r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"encFormat",value:e,checked:m.format===e,onChange:()=>b(u,"format",e),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"text-sm text-gray-700",children:e})]},e))})]}),r.jsxs("button",{onClick:()=>h(!0),className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl transition-colors shadow-lg shadow-blue-600/20 flex items-center justify-center gap-2 cursor-pointer",children:[r.jsx(a,{className:"w-4 h-4"})," ",c("tools_ui.common.encrypt")]}),m.error&&r.jsx("div",{className:"p-4 bg-red-50 text-red-600 rounded-xl text-sm border border-red-100",children:m.error}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:c("tools_ui.aes_tool.encrypted_output")}),m.output&&r.jsxs("button",{onClick:()=>f(m.output),className:"text-xs flex items-center gap-1 text-blue-600 hover:text-blue-700 font-medium cursor-pointer",children:[r.jsx(l,{className:"w-3 h-3"})," ",c("tools_ui.common.copy")]})]}),r.jsx("textarea",{readOnly:!0,className:"w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-gray-600 resize-y min-h-30 font-mono text-sm",placeholder:c("tools_ui.common.result_placeholder"),value:m.output})]})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsx("div",{className:"bg-green-50/50 px-6 py-4 border-b border-green-100 flex items-center justify-between",children:r.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[r.jsx(o,{className:"w-5 h-5 text-green-600"})," ",c("tools_ui.aes_tool.decrypt_title")]})}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c("tools_ui.aes_tool.decrypt_input_label")}),r.jsx("textarea",{className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all outline-none resize-y min-h-30",placeholder:c("tools_ui.aes_tool.decrypt_placeholder"),value:p.text,onChange:e=>b(g,"text",e.target.value)})]}),r.jsx(x,{prefix:"dec",state:p,setter:g}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c("tools_ui.aes_tool.input_format")}),r.jsx("div",{className:"flex gap-4",children:["Base64","Hex"].map(e=>r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"decInputFormat",value:e,checked:p.inputFormat===e,onChange:()=>b(g,"inputFormat",e),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),r.jsx("span",{className:"text-sm text-gray-700",children:e})]},e))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c("tools_ui.aes_tool.output_format")}),r.jsx("div",{className:"flex gap-4",children:["Utf8","Base64"].map(e=>r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"decFormat",value:e,checked:p.format===e,onChange:()=>b(g,"format",e),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Utf8"===e?"Plain Text":e})]},e))})]})]}),r.jsxs("button",{onClick:()=>h(!1),className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-xl transition-colors shadow-lg shadow-green-600/20 flex items-center justify-center gap-2 cursor-pointer",children:[r.jsx(o,{className:"w-4 h-4"})," ",c("tools_ui.common.decrypt")]}),p.error&&r.jsx("div",{className:"p-4 bg-red-50 text-red-600 rounded-xl text-sm border border-red-100",children:p.error}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:c("tools_ui.aes_tool.decrypted_output")}),p.output&&r.jsxs("button",{onClick:()=>f(p.output),className:"text-xs flex items-center gap-1 text-green-600 hover:text-green-700 font-medium cursor-pointer",children:[r.jsx(l,{className:"w-3 h-3"})," ",c("tools_ui.common.copy")]})]}),r.jsx("textarea",{readOnly:!0,className:"w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-gray-600 resize-y min-h-30 font-mono text-sm",placeholder:c("tools_ui.common.result_placeholder"),value:p.output})]})]})]})]})]})}const x=({prefix:e,state:s,setter:t})=>{const a="ECB"===s.mode,l=["CFB","OFB","CTR"].includes(s.mode),o=(e,s)=>{t(t=>{const r={...t,[e]:s};return"mode"===e&&(["CFB","OFB","CTR"].includes(s)?r.padding="NoPadding":"NoPadding"===r.padding&&(r.padding="Pkcs7")),r})};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cipher Mode"}),r.jsx("select",{className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none bg-white",value:s.mode,onChange:e=>o("mode",e.target.value),children:Object.keys(n).map(e=>r.jsx("option",{value:e,children:e},e))})]}),!l&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Padding"}),r.jsx("select",{className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none bg-white",value:s.padding,onChange:e=>o("padding",e.target.value),children:Object.keys(i).map(e=>r.jsx("option",{value:e,children:e},e))})]})]}),!a&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IV (Initialization Vector)"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none transition-colors",placeholder:"Optional (16 chars)",value:s.iv,onChange:e=>o("iv",e.target.value)})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Size (Bits)"}),r.jsx("select",{className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none bg-white",value:s.keySize,onChange:e=>o("keySize",e.target.value),children:["128","192","256"].map(e=>r.jsx("option",{value:e,children:e},e))})]})}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Secret Key","Utf8"===s.keyType&&r.jsxs("span",{className:"text-gray-500 font-normal ml-1",children:["(requires ",parseInt(s.keySize)/8," chars)"]})]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"text",className:"w-full pl-3 pr-16 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none transition-colors",placeholder:"Enter secret key",value:s.secret,onChange:e=>o("secret",e.target.value)}),r.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 font-medium",children:[s.secret.length," chars"]})]}),r.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[r.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Treat Key As:"}),r.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[r.jsx("input",{type:"radio",name:`${e}-keyType`,value:"Passphrase",checked:"Passphrase"===s.keyType,onChange:()=>o("keyType","Passphrase"),className:"w-3.5 h-3.5 text-blue-600"}),r.jsx("span",{className:"text-xs text-gray-600",children:"Passphrase"})]}),r.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[r.jsx("input",{type:"radio",name:`${e}-keyType`,value:"Utf8",checked:"Utf8"===s.keyType,onChange:()=>o("keyType","Utf8"),className:"w-3.5 h-3.5 text-blue-600"}),r.jsx("span",{className:"text-xs text-gray-600",children:"Raw Text (UTF-8)"})]})]})]})]})};export{c as default};
