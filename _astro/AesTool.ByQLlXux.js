import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as f}from"./index.BR1w_nJd.js";import{C as l}from"./index.DvoEPaQ-.js";import"./i18n.D5xAk-hA.js";import{u as S}from"./useTranslation.C-NthtKk.js";import{L as y}from"./lock.BwDUyFyp.js";import{C as j}from"./copy.C0lunkjJ.js";import{L as N}from"./lock-open.C6CnV6Zx.js";import"./_commonjsHelpers.D6-XlEtG.js";import"./_commonjs-dynamic-modules.TDtrdbi3.js";import"./___vite-browser-external_commonjs-proxy.DknZ_9ug.js";import"./createLucideIcon._FvKnKwF.js";const w={CBC:l.mode.CBC,ECB:l.mode.ECB,CFB:l.mode.CFB,OFB:l.mode.OFB,CTR:l.mode.CTR},C={PKCS5:l.pad.Pkcs7,Pkcs7:l.pad.Pkcs7,Iso97971:l.pad.Iso97971,AnsiX923:l.pad.AnsiX923,Iso10126:l.pad.Iso10126,ZeroPadding:l.pad.ZeroPadding,NoPadding:l.pad.NoPadding},v={text:"",mode:"CBC",padding:"Pkcs7",iv:"",keySize:"128",secret:"",format:"Base64",inputFormat:"Base64",output:"",error:"",keyType:"Utf8"};function L(){const{t:r}=S(),[o,p]=f.useState({...v}),[i,x]=f.useState({...v,format:"Utf8"}),d=t=>{const a=t?o:i,g=t?p:x;if(g(n=>({...n,error:"",output:""})),!a.text||!a.secret){g(n=>({...n,error:r("tools_ui.aes_tool.validation_error")}));return}try{const n={mode:w[a.mode],padding:C[a.padding]};a.iv&&a.mode!=="ECB"&&(n.iv=l.enc.Utf8.parse(a.iv));let c=a.secret;a.keyType==="Utf8"&&(c=l.enc.Utf8.parse(a.secret));let m;if(t){const u=l.AES.encrypt(a.text,c,n);m=a.format==="Base64"?u.toString():u.ciphertext.toString(l.enc.Hex)}else{let u=a.text;a.inputFormat==="Hex"&&(u={ciphertext:l.enc.Hex.parse(a.text.replace(/\s/g,""))});const b=l.AES.decrypt(u,c,n),k=b.toString(l.enc.Utf8);m=a.format==="Base64"?b.toString(l.enc.Base64):k,!m&&b.sigBytes>0&&a.format}!m&&a.text,g(u=>({...u,output:m}))}catch(n){let c=n.message||"Operation failed.";c.includes("Malformed UTF-8")?c=r("tools_ui.aes_tool.error_malformed"):c.toLowerCase().includes("cannot read properties of undefined")?c=r("tools_ui.aes_tool.error_config"):c==="Operation failed."?c=r("tools_ui.aes_tool.error_operation"):c=n.message||"Operation failed.",g(m=>({...m,error:c})),console.error(n)}},s=(t,a,g)=>{t(n=>({...n,[a]:g}))},h=t=>{navigator.clipboard.writeText(t)};return e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 sm:text-4xl mb-4",children:r("tools_ui.aes_tool.title")}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:r("tools_ui.aes_tool.subtitle")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-blue-50/50 px-6 py-4 border-b border-blue-100 flex items-center justify-between",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-blue-600"})," ",r("tools_ui.aes_tool.encrypt_title")]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("tools_ui.aes_tool.encrypt_input_label")}),e.jsx("textarea",{className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all outline-none resize-y min-h-30",placeholder:r("tools_ui.aes_tool.input_placeholder"),value:o.text,onChange:t=>s(p,"text",t.target.value)})]}),e.jsx(_,{prefix:"enc",state:o,setter:p}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("tools_ui.aes_tool.output_format")}),e.jsx("div",{className:"flex gap-4",children:["Base64","Hex"].map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"encFormat",value:t,checked:o.format===t,onChange:()=>s(p,"format",t),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:t})]},t))})]}),e.jsxs("button",{onClick:()=>d(!0),className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl transition-colors shadow-lg shadow-blue-600/20 flex items-center justify-center gap-2 cursor-pointer",children:[e.jsx(y,{className:"w-4 h-4"})," ",r("tools_ui.common.encrypt")]}),o.error&&e.jsx("div",{className:"p-4 bg-red-50 text-red-600 rounded-xl text-sm border border-red-100",children:o.error}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:r("tools_ui.aes_tool.encrypted_output")}),o.output&&e.jsxs("button",{onClick:()=>h(o.output),className:"text-xs flex items-center gap-1 text-blue-600 hover:text-blue-700 font-medium cursor-pointer",children:[e.jsx(j,{className:"w-3 h-3"})," ",r("tools_ui.common.copy")]})]}),e.jsx("textarea",{readOnly:!0,className:"w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-gray-600 resize-y min-h-30 font-mono text-sm",placeholder:r("tools_ui.common.result_placeholder"),value:o.output})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-green-50/50 px-6 py-4 border-b border-green-100 flex items-center justify-between",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-green-600"})," ",r("tools_ui.aes_tool.decrypt_title")]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("tools_ui.aes_tool.decrypt_input_label")}),e.jsx("textarea",{className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all outline-none resize-y min-h-30",placeholder:r("tools_ui.aes_tool.decrypt_placeholder"),value:i.text,onChange:t=>s(x,"text",t.target.value)})]}),e.jsx(_,{prefix:"dec",state:i,setter:x}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("tools_ui.aes_tool.input_format")}),e.jsx("div",{className:"flex gap-4",children:["Base64","Hex"].map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"decInputFormat",value:t,checked:i.inputFormat===t,onChange:()=>s(x,"inputFormat",t),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:t})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("tools_ui.aes_tool.output_format")}),e.jsx("div",{className:"flex gap-4",children:["Utf8","Base64"].map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"decFormat",value:t,checked:i.format===t,onChange:()=>s(x,"format",t),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:t==="Utf8"?"Plain Text":t})]},t))})]})]}),e.jsxs("button",{onClick:()=>d(!1),className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-xl transition-colors shadow-lg shadow-green-600/20 flex items-center justify-center gap-2 cursor-pointer",children:[e.jsx(N,{className:"w-4 h-4"})," ",r("tools_ui.common.decrypt")]}),i.error&&e.jsx("div",{className:"p-4 bg-red-50 text-red-600 rounded-xl text-sm border border-red-100",children:i.error}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:r("tools_ui.aes_tool.decrypted_output")}),i.output&&e.jsxs("button",{onClick:()=>h(i.output),className:"text-xs flex items-center gap-1 text-green-600 hover:text-green-700 font-medium cursor-pointer",children:[e.jsx(j,{className:"w-3 h-3"})," ",r("tools_ui.common.copy")]})]}),e.jsx("textarea",{readOnly:!0,className:"w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 text-gray-600 resize-y min-h-30 font-mono text-sm",placeholder:r("tools_ui.common.result_placeholder"),value:i.output})]})]})]})]})]})}const _=({prefix:r,state:o,setter:p})=>{const i=o.mode==="ECB",x=["CFB","OFB","CTR"].includes(o.mode),d=(s,h)=>{p(t=>{const a={...t,[s]:h};return s==="mode"&&(["CFB","OFB","CTR"].includes(h)?a.padding="NoPadding":a.padding==="NoPadding"&&(a.padding="Pkcs7")),a})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cipher Mode"}),e.jsx("select",{className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none bg-white",value:o.mode,onChange:s=>d("mode",s.target.value),children:Object.keys(w).map(s=>e.jsx("option",{value:s,children:s},s))})]}),!x&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Padding"}),e.jsx("select",{className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none bg-white",value:o.padding,onChange:s=>d("padding",s.target.value),children:Object.keys(C).map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),!i&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IV (Initialization Vector)"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none transition-colors",placeholder:"Optional (16 chars)",value:o.iv,onChange:s=>d("iv",s.target.value)})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Size (Bits)"}),e.jsx("select",{className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none bg-white",value:o.keySize,onChange:s=>d("keySize",s.target.value),children:["128","192","256"].map(s=>e.jsx("option",{value:s,children:s},s))})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Secret Key",o.keyType==="Utf8"&&e.jsxs("span",{className:"text-gray-500 font-normal ml-1",children:["(requires ",parseInt(o.keySize)/8," chars)"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"w-full pl-3 pr-16 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none transition-colors",placeholder:"Enter secret key",value:o.secret,onChange:s=>d("secret",s.target.value)}),e.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 font-medium",children:[o.secret.length," chars"]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Treat Key As:"}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"radio",name:`${r}-keyType`,value:"Passphrase",checked:o.keyType==="Passphrase",onChange:()=>d("keyType","Passphrase"),className:"w-3.5 h-3.5 text-blue-600"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Passphrase"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"radio",name:`${r}-keyType`,value:"Utf8",checked:o.keyType==="Utf8",onChange:()=>d("keyType","Utf8"),className:"w-3.5 h-3.5 text-blue-600"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Raw Text (UTF-8)"})]})]})]})]})};export{L as default};
